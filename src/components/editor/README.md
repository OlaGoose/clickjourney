# 旅游编辑器 (Travel Editor)

## 功能概述

旅游编辑器是一个精致的现代化内容编辑器，用于创建和编辑旅行回忆。设计风格延续了 Upload 页面和回忆详情页的精致现代风格，类似现代版 Airbnb。

## 主要功能

### 1. 照片展示区
- **4宫格布局**：固定展示4张照片，采用特色圆角设计（外角36px，内角6px）
- **照片管理**：支持添加、替换和查看照片
- **照片查看器**：点击照片可全屏查看，左右滑动浏览

### 2. 内容编辑区

#### 标题和描述
- 标题输入框：支持最多100个字符
- 描述输入框：支持最多500个字符

#### 内容块系统
支持4种类型的内容块：

1. **文本块** 📝
   - 富文本输入
   - 支持多行文本
   - 实时预览

2. **图片块** 🖼️
   - 支持上传本地图片
   - 点击替换
   - 自动压缩和优化

3. **视频块** 🎥
   - 支持上传本地视频
   - 内置播放器
   - 显示视频缩略图

4. **音频块** 🎵
   - 支持上传音频文件
   - 内置音频播放器
   - 显示文件名

### 3. 交互特性

#### 内容块交互
- **悬停效果**：鼠标悬停显示"编辑"按钮
- **选中状态**：点击内容块高亮显示
- **快速编辑**：点击"编辑"按钮打开底部编辑面板

#### 底部编辑面板
- **iOS Sheet 风格**：从底部滑出的面板
- **拖拽手柄**：顶部拖拽指示器
- **分类编辑**：根据内容块类型显示相应编辑器
- **操作按钮**：
  - 删除按钮（左侧，红色）
  - 关闭按钮（右侧）
  - 完成按钮（底部，全宽）

#### 添加内容块
- **浮动按钮**：页面底部圆形"+"按钮
- **展开菜单**：点击显示4种内容块类型选项
- **快速选择**：点击类型即可添加并打开编辑面板

### 4. 数据管理

#### 自动保存
- 草稿自动保存到 localStorage
- 每1秒保存一次
- 刷新页面不丢失内容

#### 正式保存
- 点击右上角"保存"按钮
- 数据保存到数据库（已登录用户）或 localStorage（未登录用户）
- 保存后清除草稿
- 自动跳转到回忆列表页

## 使用流程

### 从 Upload 页面进入

1. 在 Upload 页面上传照片
2. 进入第二步（音频录制步骤）
3. 点击底部工具栏的 "Edit Journey" 按钮
4. 系统自动将上传的照片传递到编辑器

### 编辑内容

1. **添加照片**（如果不足4张）：点击照片网格右下角的相机图标
2. **编辑标题**：点击顶部"输入标题..."区域
3. **编辑描述**：点击"添加描述..."区域
4. **添加内容块**：
   - 点击底部圆形"+"按钮
   - 选择内容类型（文本/图片/视频/音频）
   - 在弹出的编辑面板中编辑内容
   - 点击"完成"保存
5. **编辑已有内容块**：
   - 点击内容块选中
   - 点击"编辑"按钮
   - 在弹出的面板中修改
6. **删除内容块**：在编辑面板中点击"删除"按钮

### 保存和退出

- **保存**：点击右上角"保存"按钮
- **返回**：点击左上角返回按钮（会提示确认）

## 技术实现

### 组件架构

```
TravelEditorPage (主页面)
├── EditorHeader (头部导航)
├── PhotoGridSection (照片网格)
├── ContentBlock (内容块，可复用)
├── EditPanel (底部编辑面板)
└── AddBlockButton (添加按钮)
```

### 数据结构

```typescript
interface TravelEditorData {
  title: string;
  description: string;
  images: string[]; // 最多4张
  blocks: ContentBlock[];
}

interface ContentBlock {
  id: string;
  type: 'text' | 'image' | 'video' | 'audio';
  content: string;
  order: number;
  metadata?: {
    duration?: number;
    thumbnail?: string;
    fileName?: string;
  };
}
```

### 设计规范

#### 颜色
- 主色：黑色 (#000000)
- 背景：白色 (#FFFFFF)
- 文字：
  - 主要文字：text-black
  - 次要文字：text-gray-600
  - 占位符：text-gray-300

#### 圆角
- 按钮：rounded-full
- 内容卡片：rounded-2xl
- 编辑面板：rounded-t-[32px]
- 照片网格：外角36px，内角6px

#### 动画
- 淡入：animate-fadeIn (0.3s)
- 滑出：translate-y（底部面板）
- 缩放：active:scale-95（按钮点击）

#### 间距
- 页面边距：px-4
- 内容块间距：space-y-4
- 按钮内边距：px-4 py-2.5

## 最佳实践

1. **性能优化**
   - 图片懒加载
   - 防抖保存（1秒间隔）
   - 组件 memo 优化

2. **用户体验**
   - 确认对话框（离开页面、删除内容）
   - 加载状态提示
   - 错误提示

3. **可访问性**
   - 所有按钮有 aria-label
   - 键盘导航支持
   - 语义化 HTML

4. **数据安全**
   - 自动保存草稿
   - 保存失败重试提示
   - 本地存储备份

## 未来扩展

- [ ] 拖拽排序内容块
- [ ] 富文本编辑器增强
- [ ] 模板系统
- [ ] 协作编辑
- [ ] 导出功能（PDF/图片）
- [ ] AI 辅助生成内容
